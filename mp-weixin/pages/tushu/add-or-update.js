(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/tushu/add-or-update"],{"0fa4":function(e,t,u){},1275:function(e,t,u){"use strict";var n=u("0fa4"),r=u.n(n);r.a},2328:function(e,t,u){"use strict";u.r(t);var n=u("2e86"),r=u.n(n);for(var s in n)"default"!==s&&function(e){u.d(t,e,(function(){return n[e]}))}(s);t["default"]=r.a},"2e86":function(e,t,u){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(u("a34a"));function r(e){return e&&e.__esModule?e:{default:e}}function s(e,t,u,n,r,s,a){try{var i=e[s](a),o=i.value}catch(c){return void u(c)}i.done?t(o):Promise.resolve(o).then(n,r)}function a(e){return function(){var t=this,u=arguments;return new Promise((function(n,r){var a=e.apply(t,u);function i(e){s(a,n,r,i,o,"next",e)}function o(e){s(a,n,r,i,o,"throw",e)}i(void 0)}))}}var i=function(){Promise.all([u.e("common/vendor"),u.e("components/w-picker/w-picker")]).then(function(){return resolve(u("b7aa"))}.bind(null,u)).catch(u.oe)},o={data:function(){return{cross:"",ro:{tushuName:!1,tushuPhoto:!1,tushuZuozhe:!1,tushuChubanshe:!1,tushuFile:!1,tushuTypes:!1,tushuKucunNumber:!1,tushuNewMoney:!1,shangxiaTypes:!1,tushuDelete:!1,tushuContent:!1,createTime:!1},ruleForm:{tushuName:"",tushuPhoto:"",tushuZuozhe:"",tushuChubanshe:"",tushuFile:"",tushuTypes:"",tushuValue:"",tushuKucunNumber:"",tushuNewMoney:"",shangxiaTypes:"",shangxiaValue:"",tushuDelete:"",tushuContent:"",createTime:""},user:{},tushuTypesOptions:[],tushuTypesIndex:0,shangxiaTypesOptions:[],shangxiaTypesIndex:0}},components:{wPicker:i},computed:{baseUrl:function(){return this.$base.url}},onLoad:function(e){var t=this;return a(n.default.mark((function u(){var r,s,a,i,o;return n.default.wrap((function(u){while(1)switch(u.prev=u.next){case 0:return r={page:1,limit:100,dicCode:"tushu_types"},u.next=3,t.$api.page("dictionary",r);case 3:return s=u.sent,t.tushuTypesOptions=s.data.list,a={page:1,limit:100,dicCode:"shangxia_types"},u.next=8,t.$api.page("dictionary",a);case 8:if(i=u.sent,t.shangxiaTypesOptions=i.data.list,!e.id){u.next=16;break}return t.ruleForm.id=e.id,u.next=14,t.$api.info("tushu",t.ruleForm.id);case 14:o=u.sent,t.ruleForm=o.data;case 16:e.tushuId&&(t.ruleForm.tushuId=e.tushuId);case 17:case"end":return u.stop()}}),u)})))()},methods:{tushuTypesChange:function(e){this.tushuTypesIndex=e.target.value,this.ruleForm.tushuValue=this.tushuTypesOptions[this.tushuTypesIndex].indexName,this.ruleForm.tushuTypes=this.tushuTypesOptions[this.tushuTypesIndex].codeIndex},shangxiaTypesChange:function(e){this.shangxiaTypesIndex=e.target.value,this.ruleForm.shangxiaValue=this.shangxiaTypesOptions[this.shangxiaTypesIndex].indexName,this.ruleForm.shangxiaTypes=this.shangxiaTypesOptions[this.shangxiaTypesIndex].codeIndex},tushuPhotoTap:function(){var e=this;this.$api.upload((function(t){e.ruleForm.tushuPhoto=e.$base.url+"upload/"+t.file,e.$forceUpdate(),e.$nextTick((function(){}))}))},tushuFileTap:function(){var e=this;this.$api.upload((function(t){e.ruleForm.tushuFile=e.$base.url+"upload/"+t.file,e.$forceUpdate(),e.$nextTick((function(){}))}))},createTimeConfirm:function(e){console.log(e),this.ruleForm.createTime=e.result,this.$forceUpdate()},getUUID:function(){return(new Date).getTime()},onSubmitTap:function(){var t=this;return a(n.default.mark((function u(){return n.default.wrap((function(u){while(1)switch(u.prev=u.next){case 0:if(t.ruleForm.tushuName){u.next=3;break}return t.$utils.msg("图书名称不能为空"),u.abrupt("return");case 3:if(t.ruleForm.tushuPhoto){u.next=6;break}return t.$utils.msg("图书图片不能为空"),u.abrupt("return");case 6:if(t.ruleForm.tushuZuozhe){u.next=9;break}return t.$utils.msg("作者不能为空"),u.abrupt("return");case 9:if(t.ruleForm.tushuChubanshe){u.next=12;break}return t.$utils.msg("出版社不能为空"),u.abrupt("return");case 12:if(t.ruleForm.tushuKucunNumber||t.$validate.isIntNumer(t.ruleForm.tushuKucunNumber)||!(t.ruleForm.tushuKucunNumber>0)){u.next=15;break}return t.$utils.msg("图书库存不能为空，不能小于0 格式为数字"),u.abrupt("return");case 15:if(!t.ruleForm.id){u.next=20;break}return u.next=18,t.$api.update("tushu",t.ruleForm);case 18:u.next=22;break;case 20:return u.next=22,t.$api.save("tushu",t.ruleForm);case 22:e.setStorageSync("pingluenStateState",!0),t.$utils.msgBack("提交成功");case 24:case"end":return u.stop()}}),u)})))()},getDate:function(e){var t=new Date,u=t.getFullYear(),n=t.getMonth()+1,r=t.getDate();return"start"===e?u-=60:"end"===e&&(u+=2),n=n>9?n:"0"+n,r=r>9?r:"0"+r,"".concat(u,"-").concat(n,"-").concat(r)},toggleTab:function(e){this.$refs[e].show()}}};t.default=o}).call(this,u("543d")["default"])},"7bcc":function(e,t,u){"use strict";u.r(t);var n=u("e78a"),r=u("2328");for(var s in r)"default"!==s&&function(e){u.d(t,e,(function(){return r[e]}))}(s);u("1275");var a,i=u("f0c5"),o=Object(i["a"])(r["default"],n["b"],n["c"],!1,null,"1b2aeffe",null,!1,n["a"],a);t["default"]=o.exports},b20b:function(e,t,u){"use strict";(function(e){u("48e8");n(u("66fd"));var t=n(u("7bcc"));function n(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=u,e(t.default)}).call(this,u("543d")["createPage"])},e78a:function(e,t,u){"use strict";u.d(t,"b",(function(){return r})),u.d(t,"c",(function(){return s})),u.d(t,"a",(function(){return n}));var n={wPicker:function(){return Promise.all([u.e("common/vendor"),u.e("components/w-picker/w-picker")]).then(u.bind(null,"b7aa"))}},r=function(){var e=this,t=e.$createElement;e._self._c},s=[]}},[["b20b","common/runtime","common/vendor"]]]);